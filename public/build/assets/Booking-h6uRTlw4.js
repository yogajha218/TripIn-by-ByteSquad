import{r as o,D as V,j as e,W as D}from"./app-QBD4Hm3M.js";import{C as E}from"./CardComponent-Dn5Uy0Ad.js";import F from"./SelectOriginBooking-Ddmm8TRd.js";import{F as T}from"./ChevronLeftIcon-TMD-67a6.js";import"./format-BzRktsyD.js";const O=({setSelectedDay:l,data:i})=>(o.useEffect(()=>{const s=document.querySelector("#default-datepicker");if(s)return new V(s,{autohide:!0}),s.addEventListener("changeDate",d=>{const u=d.target.value;l("selectedDay",u)}),()=>{s.removeEventListener("changeDate",()=>{})}},[l]),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"default-datepicker",className:"block mb-2 text-sm font-medium text-gray-900",children:"Select Date"}),e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx("div",{className:"absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})})}),e.jsx("input",{readOnly:!0,value:i.selectedDay,onChange:s=>l("selectedDay",s.target.value),"data-datepicker":"true",id:"default-datepicker",type:"text",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date"})]})]})),q=({todays:l,locations:i})=>{const[s,d]=o.useState(!1),u=[...new Set(i.map(r=>r.city))],[b,m]=o.useState(!1),[v,j]=o.useState(""),[y,x]=o.useState(!1),w=u.filter(r=>r.toLowerCase().includes(v.toLowerCase())),p=o.useRef(null),{data:n,setData:c,post:k,processing:z,errors:B}=D({cityValue:"",origin:"",selectedDay:"",seatsValue:null}),N=r=>{r.preventDefault();const a=document.head.querySelector('meta[name="csrf-token"]').content;try{const t=k(route("booking.store"),n,{headers:{"X-CSRF-TOKEN":a}})}catch(t){t.response?(console.error("Server Error:",t.response.data),alert(t.response.data.message||"An error occurred on the server.")):t.request?(console.error("Network Error:",t.request),alert("Network error. Please check your internet connection and try again.")):(console.error("Error:",t.message),alert("An unexpected error occurred. Please try again."))}},C=n.cityValue?i.filter(r=>r.city.toLowerCase()===n.cityValue.toLowerCase()):i;o.useEffect(()=>{d(g.length>0)},[l]),o.useEffect(()=>{const r=a=>{p.current&&!p.current.contains(a.target)&&m(!1)};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[]);const g=l.map(r=>{var a,t,h,f;return{id:r.booking_id,name:"Shuttle Bus Tripin",plateNumber:(a=r.trips[0])==null?void 0:a.schedule.vehicle.license_plate,origin:(t=r.trips[0])==null?void 0:t.origin,destination:(h=r.trips[0])==null?void 0:h.schedule.location.name,status:"On Trip",price:r.price,date:(f=r.trips[0])==null?void 0:f.selected_day}}),S=r=>{j(r.target.value),r.target.value===r.target.value.toLowerCase()&&(r.target.value=r.target.value.toUpperCase()),c("cityValue",r.target.value)},L=r=>{r===r.toLowerCase()&&(r=r.toUpperCase()),c("cityValue",r),m(!1)};return e.jsx(e.Fragment,{children:y?e.jsx(F,{setIsSelectOrigin:x,setOrigin:c,locations:C}):e.jsx("div",{className:"lg:flex lg:justify-center",children:e.jsxs("div",{className:"min-h-screen bg-white lg:w-[400px]",children:[e.jsxs("div",{className:"relative flex h-[108px] items-center justify-center rounded-b-lg bg-primary px-3",children:[e.jsx(T,{onClick:()=>window.location.href="/home",className:"absolute left-3 top-1/2 z-50 size-8 translate-y-[-50%] cursor-pointer font-bold text-white"}),e.jsx("p",{className:"mx-2 w-fit cursor-default select-none text-2xl font-medium text-white",children:"Booking"})]}),e.jsx("div",{className:"m-5 rounded-md border p-4 shadow-md",children:e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"input-group-1",className:"mb-2 block text-sm font-medium text-gray-900",children:"Departure City"}),e.jsxs("div",{className:"relative mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 start-0 z-10 flex items-center ps-3.5",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"})})}),e.jsx("input",{type:"text",id:"input-group-1",className:"block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 ps-10 text-sm text-gray-900 focus:border-blue-500 focus:ring-blue-500",placeholder:"From",value:n.cityValue,onChange:S,onFocus:()=>m(!0)})]}),b&&e.jsx("ul",{ref:p,className:"relative mt-1 size-fit w-full rounded-lg border border-gray-300 bg-white shadow-lg",children:w.map((r,a)=>e.jsx("li",{className:"cursor-pointer px-4 py-2 hover:bg-gray-100",onClick:()=>L(r),children:r},a))})]}),e.jsx("label",{htmlFor:"input-group-1",className:"mb-2 block text-sm font-medium text-gray-900",children:"Place"}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 start-0 flex items-center ps-3.5",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-6",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"})]})}),e.jsx("input",{defaultValue:n.origin,id:"input-group-1",className:"block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 ps-10 text-sm text-gray-900 focus:border-blue-500 focus:ring-blue-500",placeholder:"   From",onFocus:()=>{x(!0)}})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-3",children:[e.jsx("div",{children:e.jsx(O,{setSelectedDay:c,data:n})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"countries",className:"mb-2 block text-sm font-medium text-gray-900 dark:text-white",children:"Select Seat"}),e.jsxs("select",{onChange:r=>c("seatsValue",parseInt(r.target.value)),defaultValue:"",id:"countries",className:"block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",disabled:!0,children:"Choose a seat"}),e.jsx("option",{value:"1",children:"1"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"}),e.jsx("option",{value:"4",children:"4"}),e.jsx("option",{value:"5",children:"5"})]})]})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",className:"mt-7 w-full rounded-lg bg-primary2 py-2 text-white",children:"Search"})})]})}),e.jsxs("div",{children:[e.jsx("div",{className:"px-5 font-semibold text-black",children:"Today's Trip"}),e.jsx("div",{className:"mt-2 grid gap-4 px-5",children:s?e.jsx(E,{CardProp:g}):e.jsxs("div",{className:"flex flex-col items-center justify-center pb-9",children:[e.jsx("img",{src:"/tayo-bus.svg ",loading:"lazy"}),e.jsx("p",{children:"no tayo trip available"})]})})]})]})})})};export{q as default};
