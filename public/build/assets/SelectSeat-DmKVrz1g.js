import{j as e,r as i,b as w}from"./app-BnX73pR_.js";import{T as N}from"./ToastComponent-CslW7D78.js";import{F as v}from"./ChevronLeftIcon-Dju_cjsl.js";const S=({number:c,isSelected:a,isBooked:s,onClick:d})=>e.jsxs("div",{className:`w-12 h-12 flex flex-col items-center justify-center rounded-md ${s?"bg-gray-400 text-white cursor-not-allowed opacity-75":a?"bg-[#009EF7] text-white":"bg-white text-black"} shadow-md ${s?"cursor-not-allowed":"cursor-pointer"}`,onClick:s?null:d,children:[e.jsx("div",{className:"mt-2 text-[15px] font-bold",children:c})," ",e.jsx("div",{className:`w-12 h-3 mt-2 rounded-full ${a?"bg-white":"bg-[#394867]"}`})]}),T=({plate:c,seatLimit:a})=>{const[s,d]=i.useState([]),[m,x]=i.useState(0),[h,b]=i.useState([]),[f,l]=i.useState(""),[p,o]=i.useState(""),j=[{number:1},{number:2},{type:"null"},{type:"steeringWheel"},{type:"null"},{number:3},{number:4},{number:5},{number:6},{number:7},{number:8},{number:9},{type:"null"},{number:10},{number:11},{number:12},{type:"null"},{number:13},{number:14},{number:15},{number:16},{number:17},{number:18},{number:19}];i.useLayoutEffect(()=>{c&&(async()=>{try{const r=await w.get(`/booking/seat/booked-seat/${c.selectedRoute.plate}`);b(r.data.booked_seats)}catch(r){console.error("Error fetching booked seats:",r),o("alert"),l("Failed to fetch booked seats. Please try again.")}})()},[c]);const g=t=>{s.includes(t)?(d(s.filter(r=>r!==t)),x(m-1)):s.length<a?(d([...s,t]),x(m+1)):(o("alert"),l(`You can only select up to ${a} seat(s).`))},y=async t=>{if(t.preventDefault(),s.length!==a){o("warning"),l(`you need to select ${a-s.length} more seat(s)`);return}const r=document.head.querySelector('meta[name="csrf-token"]').content;try{const n=await fetch(route("seat.store",c.selectedRoute.plate),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":r},body:JSON.stringify({seats:s,seatCount:m})});if(console.log("Response Status: ",n.status),n.ok){const u=await n.json();o("success"),l(u.message),window.location.href="/booking/order-detail"}else{const u=await n.json();o("alert"),l(u.message)}}catch(n){n.response?(console.error("Server Error:",n.response.data),o("alert"),l(n.response.data.message||"An error occurred on the server.")):n.request?(console.error("Network Error:",n.request),o("alert"),l("Network error. Please check your internet connection and try again.")):(console.error("Error:",n.message),o("alert"),l("An unexpected  error occurred. Please try again."))}console.log(s)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lg:flex lg:justify-center",children:e.jsx("div",{className:"mx-auto md:min-w-[360px] lg:w-[400px]",children:e.jsxs("div",{className:"relative min-h-screen min-w-[360px] bg-white",children:[e.jsxs("div",{className:"relative h-[108px] rounded-b-xl bg-primary",children:[e.jsxs("div",{className:"mx-3 flex justify-center py-5",children:[e.jsx(v,{className:"absolute left-3 top-6 size-6 cursor-pointer text-white",onClick:()=>window.location.href="/booking/bus-schedule"}),e.jsxs("div",{className:"flex justify-center text-white",children:[e.jsx("p",{className:"w-full text-2xl font-medium",children:"Select Seat"}),e.jsx("p",{className:"text-lg font-semibold"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"border-gray size-3 border bg-white"}),e.jsx("p",{className:"ml-1.5 text-center text-sm font-semibold text-white",children:"Available"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"border-gray size-3 border bg-primary2"}),e.jsx("p",{className:"ml-1.5 text-center text-sm font-semibold text-white",children:"Filled"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"border-gray size-3 border bg-[#009EF7]"}),e.jsx("p",{className:"ml-1.5 text-center text-sm font-semibold text-white",children:"Selected"})]})]})})]}),e.jsxs("form",{onSubmit:y,children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"mt-[20px]",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("h1",{className:"text-md font-medium",children:["Seat Limit: ",s.length,"/",a]})}),e.jsx("div",{className:"mt-3 h-[430px] w-[300px] rounded-[15px] bg-[#8BAFCE]",children:e.jsx("div",{className:"flex flex-col items-center py-5",children:e.jsx("div",{className:"grid grid-cols-4 gap-4 p-4",children:j.map((t,r)=>t.type==="steeringWheel"?e.jsx("div",{className:"flex h-12 w-12 items-center justify-center",children:e.jsx("img",{src:"/steeringWheel.svg",alt:"Steering Wheel",className:"h-10 w-10"})},r):t.type==="null"?e.jsx("div",{className:""},r):e.jsx(S,{number:t.number,isBooked:Array.isArray(h)&&h.includes(t.number),isSelected:s.includes(t.number),onClick:()=>g(t.number)},r))})})})]})}),e.jsx("div",{className:"mt-2 flex w-full justify-center px-3 py-3",children:e.jsx("button",{className:"h-[45px] w-full rounded-[10px] bg-primary2 text-white",children:"Save"})})]})]})})}),f!==""&&e.jsx("div",{className:"nowrap absolute left-1/2 top-5 flex h-fit w-fit items-center justify-center",children:e.jsx(N,{message:f,onClose:()=>l(""),type:p})})]})};export{T as default};
