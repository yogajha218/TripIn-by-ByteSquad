import{r as a,j as e,b as M}from"./app-uBn0CTW0.js";import{F as q}from"./ChevronLeftIcon-CHCZY9A4.js";import{f as D}from"./format-BzRktsyD.js";function _({title:n,titleId:r,...i},d){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":r},i),n?a.createElement("title",{id:r},n):null,a.createElement("path",{fillRule:"evenodd",d:"M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5Z",clipRule:"evenodd"}))}const $=a.forwardRef(_),B=({user:n,routeData:r,bookingData:i,seatNumber:d,seatCount:C,credit:u})=>{var g,b,j,N,v,y,w,P,E;const[F,k]=a.useState(null),m={busInfo:{name:"Shuttle Bus Tripin",plateNumber:(b=(g=r[0])==null?void 0:g.vehicles[0])==null?void 0:b.license_plate,duration:"2 h 45 m",departureTime:(N=(j=r[0])==null?void 0:j.vehicles[0])==null?void 0:N.pivot.departure_time,departureDate:D(i.selectedDay,"EEE, d MMM yyyy"),arrivalTime:(y=(v=r[0])==null?void 0:v.vehicles[0])==null?void 0:y.pivot.arrival_time,arrivalDate:D(i.selectedDay,"EEE, d MMM yyyy"),from:i.origin,to:(w=r[0])==null?void 0:w.name},orderDetails:{name:(n==null?void 0:n.username)??"user1",seatNumber:d,totalSeats:i.seatsValue,potentialPoints:null,exchangePoints:u},pricing:{seatPrice:parseFloat((E=(P=r[0])==null?void 0:P.vehicles[0])==null?void 0:E.pivot.price),quantity:C}},[o,I]=a.useState(!1),[x,T]=a.useState(!1),s=m;let c=s.pricing.seatPrice*s.pricing.quantity;m.orderDetails.potentialPoints=c*.05;let p=!1;o&&(p=!0,c=s.pricing.seatPrice*s.pricing.quantity-u);const f=h=>`Rp${h.toLocaleString("id-ID")}`,O=async h=>{h.preventDefault();const R=document.head.querySelector('meta[name="csrf-token"]').content;try{const t=await M.post("/booking/order-detail/store",{amount:c,credit:m.orderDetails.potentialPoints,credit_status:p},{headers:{"X-CSRF-TOKEN":R}}),{snap_token:S}=t.data;k(S),window.snap.pay(S,{onSuccess:function(l){alert("Payment Success! "+JSON.stringify(l))},onPending:function(l){alert("Payment Pending! "+JSON.stringify(l))},onError:function(l){alert("Payment Error! "+JSON.stringify(l))},onClose:function(){alert("You closed the popup without completing the payment.")}})}catch(t){t.response?(console.error("Server Error:",t.response.data),alert(t.response.data.message||"An error occurred on the server.")):t.request?(console.error("Network Error:",t.request),alert("Network error. Please check your internet connection and try again.")):(console.error("Error:",t.message),alert("An unexpected error occurred. Please try again."))}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"lg:flex lg:justify-center",children:e.jsxs("div",{className:"min-h-screen bg-primary lg:max-w-[400px]",children:[e.jsxs("div",{className:"flex items-center px-4 py-3 text-white",children:[e.jsx(q,{className:"size-8 cursor-pointer text-white",onClick:()=>window.location.href="/booking"}),e.jsx("h1",{className:"mb-4 mr-6 mt-4 flex-1 text-center text-2xl font-medium",children:"Confirmation"})]}),e.jsxs("div",{className:"min-h-screen bg-white px-6 pt-4",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold",children:"Order Details"}),e.jsxs("div",{className:"mb-4 rounded-lg border border-gray-200 bg-white p-4 shadow-md",children:[e.jsx("h3",{className:"mb-1 font-medium",children:s.busInfo.name}),e.jsx("p",{className:"mb-4 text-sm text-gray-600",children:s.busInfo.plateNumber}),e.jsxs("div",{className:"flex items-start gap-10",children:[e.jsxs("div",{className:"flex flex-col gap-10",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.busInfo.departureTime.split(":").slice(0,2).join(":")}),e.jsx("p",{className:"text-xs text-gray-500",children:s.busInfo.departureDate})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.busInfo.arrivalTime.split(":").slice(0,2).join(":")}),e.jsx("p",{className:"text-xs text-gray-500",children:s.busInfo.arrivalDate})]})]}),e.jsxs("div",{className:"relative flex flex-col items-center",children:[e.jsx("div",{className:"size-3 rounded-full bg-blue-500"}),e.jsx("div",{className:"h-20 w-1 bg-blue-300"}),e.jsx("div",{className:"size-2.5 rounded-full bg-blue-500 ring-4 ring-blue-200"})]}),e.jsxs("div",{className:"flex flex-col gap-16",children:[e.jsx("p",{className:"font-medium",children:s.busInfo.from}),e.jsx("p",{className:"font-medium",children:s.busInfo.to})]})]})]}),e.jsxs("div",{className:"mb-4 rounded-lg border border-gray-200 bg-white p-4 shadow-md",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1 font-medium",children:s.orderDetails.name}),e.jsxs("p",{className:"text-gray-700",children:["Seat x",s.orderDetails.totalSeats]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Seat Number"}),e.jsx("p",{className:"font-medium",children:s.orderDetails.seatNumber})]})]}),e.jsxs("div",{className:"flex justify-between rounded bg-gray-50 p-2 text-sm",children:[e.jsx("p",{className:"self-start",children:"Potential gain "}),e.jsx("p",{className:"self-end text-orange-500",children:`${s.orderDetails.potentialPoints} CP`})]})]}),e.jsx("div",{className:"mb-4 rounded-lg border border-gray-200 bg-white p-4 shadow-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:"/credit.svg",alt:"Credits",className:"h-4"}),e.jsx("span",{children:`Exchange ${s.orderDetails.exchangePoints} CP`})]}),e.jsx("button",{onClick:()=>I(!o),className:`relative h-6 w-12 rounded-full transition-colors duration-200 ease-in-out ${o?"bg-orange-500":"bg-gray-200"}`,children:e.jsx("div",{className:`absolute top-0.5 h-5 w-5 rounded-full bg-white shadow transition-transform duration-200 ease-in-out ${o?"translate-x-6":"translate-x-0.5"}`})})]})}),e.jsxs("div",{className:"mb-4 rounded-lg border border-gray-200 bg-white p-4 shadow-md",children:[e.jsx("h3",{className:"mb-2 font-medium",children:"Payment Method"}),e.jsxs("div",{className:"relative",onClick:()=>T(!x),children:[e.jsxs("div",{className:"flex cursor-pointer items-center justify-between rounded border p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:"/gopay_icon.svg",alt:"Dana",className:"h-6 w-6"}),e.jsx("span",{children:"Dana"})]}),e.jsx($,{className:`size-5 text-black transition-transform duration-200 ${x?"rotate-180 transform":""}`})]}),x&&e.jsx("div",{className:"absolute z-10 mt-1 w-full rounded-lg border bg-white shadow-lg",children:e.jsxs("div",{className:"flex cursor-pointer items-center gap-2 p-2 hover:bg-gray-50",children:[e.jsx("img",{src:"/gopay_icon.svg",alt:"Dana",className:"h-6 w-6"}),e.jsx("span",{children:"Dana"})]})})]})]}),e.jsxs("div",{className:"mb-20 rounded-lg border border-gray-200 bg-white p-4 shadow-md",children:[e.jsx("h3",{className:"mb-2 font-medium",children:"Price Details"}),e.jsxs("div",{className:"mb-2 flex justify-between",children:[e.jsx("p",{children:"Seat (x1)"}),e.jsx("p",{children:f(s.pricing.seatPrice)})]}),e.jsxs("div",{className:"mb-2 flex justify-between",children:[e.jsx("p",{children:"Total seat"}),e.jsxs("p",{children:["(x",s.pricing.quantity,")"]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2 font-semibold",children:[e.jsx("p",{children:"Total Price"}),e.jsx("p",{children:f(c)})]})]}),e.jsx("div",{className:"fixed bottom-0 right-0 bg-white p-4 lg:left-1/2 lg:w-[400px] lg:translate-x-[-50%]",children:e.jsx("button",{className:"w-full rounded-lg bg-primary2 py-3 font-semibold text-white",onClick:O,children:"ORDER NOW"})})]})]})})})};export{B as default};
